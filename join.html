<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>캠핀</title>
    <link rel="stylesheet" href="/css/join.css" />
    <link href="//spoqa.github.io/spoqa-han-sans/css/SpoqaHanSans-kr.css" rel="stylesheet" type="text/css" />
    <script src="https://kit.fontawesome.com/1818959bdb.js" crossorigin="anonymous"></script>
</head>

<body>
    <div class="container">
        <div class="pop_header">
            <div class="pop_chev go_main"><i class="fas fa-chevron-left"></i></div>
            <div class="pop_title">약관동의</div>
        </div>
        <div class="pop_main">
            <div class="pop_policy">가입약관을 읽고 동의를 해주세요.</div>
            <div class="check_box">
                <label>
                    <input type="checkbox" id="check_all">
                    전체동의하기
                </label>
                <div class="check_list" id="term1">
                    <label>
                        <input type="checkbox" class="check_term">
                        서비스 이용약관 (필수)
                    </label>
                    <i class="fas fa-chevron-right"></i>
                </div>
                <div class="check_list" id="term2">
                    <label>
                        <input type="checkbox" class="check_term">
                        개인정보 처리방침 (필수)
                    </label>
                    <i class="fas fa-chevron-right"></i>
                </div>
                <div class="check_list" id="term3">
                    <label>
                        <input type="checkbox" class="check_term">
                        이벤트/마케팅 수신동의 (선택)
                    </label>
                    <i class="fas fa-chevron-right"></i>
                </div>
            </div>
        </div>
        <button class="foot_btn">다음</button>

    </div>
    <script>
        let checker = {
            term1: false,
            term2: false,
            term3: false
        }

        // 들어가야 할 기능
        // checker 동의 여부 => 전체 동의
        // 전체 동의 => ckecker 모두 true
        // 체크 박스 클릭 => checker 연동
        // checker 연동에 따른 필수항목 동의시 버튼 활성화

        /* 전체 동의 체크 */
        const checkAll = document.querySelector("#check_all")
        const checkTerm = document.querySelectorAll(".check_term")
        const footBtn = document.querySelector(".foot_btn")

        // 전체동의 체크 이벤트
        checkAll.addEventListener("change", () => {
            for (key in checker) {
                checker[key] = checkAll.checked
            }
            checkSync()
            footBtnChange()
        })

        // 개별 항목 체크 이벤트
        checkTerm.forEach(v => {
            v.addEventListener("change", (e) => {
                const { id } = e.currentTarget.parentNode.parentNode
                checker[id] = e.currentTarget.checked
                checkSync()
                footBtnChange()
                checkAllHandle()
            })
        })

        // checker와 연동 기능
        function checkSync() {
            for (key in checker) {
                document.querySelector("#" + key + " input").checked = checker[key]
            }
        }

        // 필수 항목 동의 시 버튼 변화
        function footBtnChange() {
            const { term1, term2 } = checker
            if (term1 && term2) {
                footBtn.classList = "foot_btn checked"
            } else {
                footBtn.classList = "foot_btn"
            }
        }

        // 모든 항목 체크 시 전체 동의 체크
        function checkAllHandle() {
            const { term1, term2, term3 } = checker

            if (term1 && term2 && term3) {
                checkAll.checked = true
            } else {
                checkAll.checked = false
            }
        }

        // 버튼 클릭 이벤트
        footBtn.addEventListener("click", () => {
            if (footBtn.classList != "foot_btn checked") {
                alert("필수동의 항목을 체크해주세요")
            }
        })

        /* 가입약관 페이지 이동 */
        const checkList = document.querySelectorAll(".check_list")
        checkList.forEach(v => {
            v.addEventListener("click", e => {
                location.href = e.currentTarget.id + ".html"
            })
        }) 
    </script>
</body>

</html>